# üìß –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ Spring Cloud

[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.x-brightgreen)](https://spring.io/projects/spring-boot)
[![Spring Cloud](https://img.shields.io/badge/Spring%20Cloud-2022.x-blue)](https://spring.io/projects/spring-cloud)
[![Apache Kafka](https://img.shields.io/badge/Apache%20Kafka-3.x-000)](https://kafka.apache.org)
[![Java](https://img.shields.io/badge/Java-17-orange)](https://openjdk.org/projects/jdk/17/)
[![Gradle](https://img.shields.io/badge/Gradle-Kotlin%20DSL-blue)](https://gradle.org)

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Spring Cloud.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### User-Service
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å email –∏ –ø–∞—Ä–æ–ª–µ–º
- **–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å –ø–æ–º–æ—â—å—é Spring Security
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ Kafka –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### Notification-Service
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π** –∏–∑ Kafka —Ç–æ–ø–∏–∫–∞ `user-events`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **REST API** –¥–ª—è —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SMTP-—Å–µ—Ä–≤–µ—Ä–æ–º**

### Spring Cloud Infrastructure
- **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** —á–µ—Ä–µ–∑ Spring Cloud Gateway
- **–°–µ—Ä–≤–∏—Å-–¥–∏—Å–∫–∞–≤–µ—Ä–∏** —Å Netflix Eureka
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** —á–µ—Ä–µ–∑ Config Server
- **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –Ω–∞ —É—Ä–æ–≤–Ω–µ —à–ª—é–∑–∞
- **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã API

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
flowchart TD
    Client[–ö–ª–∏–µ–Ω—Ç] --> Gateway[API Gateway]
    Gateway --> User[User-Service]
    Gateway --> Notif[Notification-Service]
    User -->|–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ| Kafka[(Kafka\nuser-events)]
    Kafka -->|–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ| Notif
    Notif --> SMTP[(SMTP –°–µ—Ä–≤–µ—Ä)]
    Config[Config Server] -.->|–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è| User
    Config -.->|–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è| Notif
    Eureka[Eureka Server] -.->|–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è| User
    Eureka -.->|–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è| Notif

    classDef serviceClass fill:#e1f5,stroke:#01s79b,stroke-width:2px
    classDef infraClass fill:#r3e5f,stroke:#4a148c,stroke-width:2px
    class User,Notif,Gateway serviceClass
    class Kafka,Config,Eureka,SMTP infraClass
```

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
1. –ö–ª–∏–µ–Ω—Ç –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ API Gateway
2. Gateway –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ –Ω—É–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å —á–µ—Ä–µ–∑ Eureka
3. User-Service –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ Kafka
4. Notification-Service –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∏–∑ Kafka –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email —á–µ—Ä–µ–∑ SMTP

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend Framework
- **Spring Boot 3.x** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
- **Spring Security + JWT** - —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Spring Data JPA** - —Ä–∞–±–æ—Ç–∞ —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- **Spring Kafka** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Apache Kafka –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π messaging
- **Spring Mail** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º —á–µ—Ä–µ–∑ SMTP

### Spring Cloud Infrastructure
- **Spring Cloud Gateway** - API —à–ª—é–∑ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Netflix Eureka** - —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
- **Spring Cloud Config** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

### Database & Messaging
- **H2/PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Apache Kafka** - –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

### Testing
- **Testcontainers** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- **JUnit 5** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Build Tool
- **Gradle (Kotlin DSL)** - —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 17 –∏–ª–∏ –≤—ã—à–µ
- Gradle 7.6+
- Docker –∏ Docker Compose
- Git

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/your-username/notification-system.git
cd notification-system
```

### 2. –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
# –ó–∞–ø—É—Å–∫ Kafka, Zookeeper –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f docker-compose-infra.yml up -d
```

### 3. –ó–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
```bash
# 1. –ó–∞–ø—É—Å–∫ Config Server
cd config-server
./gradlew bootRun

# 2. –ó–∞–ø—É—Å–∫ Eureka Server (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd eureka-server  
./gradlew bootRun

# 3. –ó–∞–ø—É—Å–∫ API Gateway (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd api-gateway
./gradlew bootRun

# 4. –ó–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ (–≤ –Ω–æ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö)
cd user-service
./gradlew bootRun

cd notification-service
./gradlew bootRun
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ: –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Gradle
```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
./gradlew :config-server:bootRun &
./gradlew :eureka-server:bootRun &
./gradlew :api-gateway:bootRun &
./gradlew :user-service:bootRun &
./gradlew :notification-service:bootRun &
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
- **Eureka Dashboard**: http://localhost:8761
- **API Gateway**: http://localhost:8081
- **Config Server**: http://localhost:8888
- **Notification Service**: http://localhost:8083
- **User Service**: http://localhost:9092


---

> ‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –í—ã—à–µ –æ–ø–∏—Å–∞–Ω–∞ —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞. –ù–∏–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –¢–ó –∏ –ø–ª–∞–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã,
> –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –Ω–æ –Ω–µ —Ç–∞–∫ –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –Ω–∏–∂–µ. –ö –ø—Ä–∏–º–µ—Ä—É, endpoint-—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ –¥—Ä—É–≥–æ–º—É. Testcontainer-—ã –Ω–∞ –¥–∞–Ω–Ω—ã–π
> –º–æ–º–µ–Ω—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.

## üöß –î–∞–ª–µ–µ —Å–ª–µ–¥—É–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –¢–ó (–Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Å—Ç–≤—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

## üîå API Endpoints

### –ß–µ—Ä–µ–∑ API Gateway (–ø–æ—Ä—Ç 8080)

#### User-Service
```http
POST /api/users/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}

DELETE /api/users/{id}
Authorization: Bearer {jwt-token}
```

#### Notification-Service
```http
POST /api/notifications/send
Authorization: Bearer {jwt-token}
Content-Type: application/json

{
  "to": "user@example.com",
  "subject": "–¢–µ–º–∞ –ø–∏—Å—å–º–∞",
  "text": "–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
}
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–≤ Config Server)
```yaml
spring:
  kafka:
    bootstrap-servers: localhost:9092
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka

jwt:
  secret: ${JWT_SECRET}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
export MAIL_USERNAME=your-email@gmail.com
export MAIL_PASSWORD=your-app-password
export JWT_SECRET=your-jwt-secret-key
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
./gradlew test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
./gradlew :user-service:test

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
./gradlew :user-service:integrationTest
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å Testcontainers
–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã:
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ User-Service
2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è –≤ Kafka
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è Notification-Service
4. –û—Ç–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ SMTP

```kotlin
@Testcontainers
class UserNotificationIntegrationTest {
    // –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Å—å —Ü–∏–∫–ª –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
}
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–µ—Ä–≤–∏—Å—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ Eureka Server: http://localhost:8761